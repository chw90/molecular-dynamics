
#####################################################
# Exercise 1: Setting up a MD simulation in LAMMPS
#####################################################

#
#####################################################
# --- Variable definition ---

variable T equal 293.15                # Desired temperature
variable P equal 101325                # Desired pressure
variable m equal 6.633521795361493e-26 # Atomic mass
variable epsilon equal 1.6567788e-21   # Lennard-Jones dispersion energy
variable sigma equal 3.405e-10         # Lennard-Jones particle size
variable n_atoms equal 100             # Number of atoms
variable time_step equal 2.0e-15       # Size of time step
variable n_time_steps equal 2000       # Number of time steps
variable n_output equal 25             # Number of time steps

variable kb equal 1.380649e-23
variable edge_length equal $((v_n_atoms*v_kb*v_T/v_P)^(1/3))


#
#####################################################
# --- Simulation characteristics ---

dimension 2
units si
atom_style atomic

#
#####################################################
# --- System construction ---

# Boundary conditions
boundary p p p

# Simulation box and initial atom positions
lattice sq $(v_edge_length/v_n_atoms^(1/2)) origin 0.5 0.5 0.0
region box block 0 $(v_n_atoms^(1/2)) 0 $(v_n_atoms^(1/2)) 0 1 units lattice
create_box 1 box
create_atoms 1 box

neighbor $(0.3*v_sigma) bin

# Atom properties/interatomic potential
mass 1 $m
pair_style lj/cut $(3*v_sigma)  # Lennard-Jones potential with cutoff distance 3*sigma
pair_coeff 1 1 ${epsilon} ${sigma}

# Initial atom velocities
velocity all create $T 1234 mom yes rot yes dist gaussian

#
#####################################################
# --- Output ---

# Thermodynamic (global) data: output to the screen and log files
thermo ${n_output}
thermo_style custom step time etotal ke pe temp press vol # lx ly lz

# Averaged thermodynamic data: output to yaml files
fix 1 all ave/time 1 500 500 c_thermo_temp c_thermo_press file av_temp_press.yaml

# Per atom data: output to dump files
dump v0 all custom 1000 argon2d.dump id x y z vx vy vz

#
#####################################################
# --- Simulation execution ---

# Simulation of a NPT ensemble
timestep ${time_step}
fix 2 all nve
fix 3 all enforce2d
run ${n_time_steps}
